<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MNS Terminal — mns.com.ge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      color: #00ff66;
      font-family: "Courier New", monospace;
      height: 100%;
      overflow: hidden;
    }
    #terminal {
      box-sizing: border-box;
      padding: 20px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      white-space: pre;
    }
    #nav {
      font-weight: bold;
      margin-bottom: 8px;
      letter-spacing: 0.5px;
    }
    #status {
      opacity: 0.7;
      margin-bottom: 20px;
      letter-spacing: 0.5px;
    }
  </style>
</head>
<body>
  <div id="terminal">
    <div id="nav"></div>
    <div id="status"></div>
  </div>

  <script>
    /* =========================
       Phase 12B — Tier 0 Observability & Public Release
       Market Navigation System (MNS)
       Target: mns.com.ge
       Mode: UI-only, deterministic, audit-grade
       ========================= */

    "use strict";

    /* ---- TIER 0 CANONICAL NAV STATE (READ-ONLY INTERFACE) ---- */
    const NAV_STATE = Object.seal({
      regime: "COMPRESSION",
      risk: "NORMAL",
      confidence: "MED",
      status: "LIVE"
    });

    /* ---- DETERMINISTIC PRNG (Seeded) ---- */
    let SEED = 42;
    function seededRandom() {
      SEED = (SEED * 9301 + 49297) % 233280;
      return SEED / 233280;
    }

    /* ---- REGIME CATALOG (IMMUTABLE) ---- */
    const REGIMES = Object.freeze([
      "ACCUMULATION",
      "EXPANSION",
      "DISLOCATION",
      "EXHAUSTION",
      "COMPRESSION"
    ]);

    /* ---- RISK LEVELS (IMMUTABLE) ---- */
    const RISK_LEVELS = Object.freeze([
      "LOW",
      "NORMAL",
      "HIGH"
    ]);

    /* ---- CONFIDENCE LEVELS (IMMUTABLE) ---- */
    const CONFIDENCE_LEVELS = Object.freeze([
      "LOW",
      "MED",
      "HIGH"
    ]);

    /* ---- DOM REFERENCES ---- */
    const navEl = document.getElementById("nav");
    const statusEl = document.getElementById("status");

    /* ---- ARCHITECTURE: UPDATE STATE (Deterministic Mock Engine) ---- */
    function updateState() {
      try {
        const r1 = seededRandom();
        const r2 = seededRandom();
        const r3 = seededRandom();

        // Deterministic regime rotation
        if (r1 < 0.1) {
          const idx = Math.floor(r2 * REGIMES.length);
          NAV_STATE.regime = REGIMES[idx];
        }

        // Deterministic risk assignment
        if (r2 < 0.15) {
          const idx = Math.floor(r3 * RISK_LEVELS.length);
          NAV_STATE.risk = RISK_LEVELS[idx];
        }

        // Deterministic confidence drift
        if (r3 < 0.2) {
          const idx = Math.floor(r1 * CONFIDENCE_LEVELS.length);
          NAV_STATE.confidence = CONFIDENCE_LEVELS[idx];
        }

        // Status is always LIVE unless fail-safe triggered
        NAV_STATE.status = "LIVE";

      } catch (err) {
        // Trigger fail-safe on any error
        triggerFailSafe();
      }
    }

    /* ---- ARCHITECTURE: SANITIZE FOR TIER 0 (Deep Clone + Strip) ---- */
    function sanitizeForTier0(state) {
      try {
        // Deep clone to prevent mutation leaks
        const sanitized = {
          regime: state.regime,
          risk: state.risk,
          confidence: state.confidence,
          status: state.status
        };

        // Validate structure
        if (!REGIMES.includes(sanitized.regime)) {
          throw new Error("Invalid regime");
        }
        if (!RISK_LEVELS.includes(sanitized.risk)) {
          throw new Error("Invalid risk");
        }
        if (!CONFIDENCE_LEVELS.includes(sanitized.confidence)) {
          throw new Error("Invalid confidence");
        }
        if (sanitized.status !== "LIVE" && sanitized.status !== "UNKNOWN") {
          throw new Error("Invalid status");
        }

        return sanitized;

      } catch (err) {
        // Return fail-safe state
        return {
          regime: "UNKNOWN",
          risk: "NORMAL",
          confidence: "LOW",
          status: "UNKNOWN"
        };
      }
    }

    /* ---- ARCHITECTURE: RENDER NAV (DOM Writes Only) ---- */
    function renderNAV(state) {
      try {
        const safeState = sanitizeForTier0(state);

        const navLine =
          `[NAV] REGIME: ${safeState.regime}` +
          ` | RISK: ${safeState.risk}` +
          ` | CONFIDENCE: ${safeState.confidence}` +
          ` | STATUS: ${safeState.status}`;

        navEl.textContent = navLine;

      } catch (err) {
        // Fail-safe render
        navEl.textContent = "[NAV] STATE: UNKNOWN";
      }
    }

    /* ---- ARCHITECTURE: RENDER STATUS (DOM Writes Only) ---- */
    function renderStatus() {
      try {
        const statusLine =
          `[STATUS] SYSTEM: LIVE` +
          ` | MODE: TIER_0` +
          ` | STREAM: PRESENT_STATE`;

        statusEl.textContent = statusLine;

      } catch (err) {
        // Fail-safe render
        statusEl.textContent = "[STATUS] SYSTEM: SAFE_MODE | MODE: TIER_0";
      }
    }

    /* ---- FAIL-SAFE HANDLER ---- */
    function triggerFailSafe() {
      try {
        // Clear all output
        navEl.textContent = "";
        statusEl.textContent = "";

        // Render fail-safe state
        navEl.textContent = "[NAV] STATE: UNKNOWN";
        statusEl.textContent = "[STATUS] SYSTEM: SAFE_MODE | MODE: TIER_0";

        // Reset NAV_STATE to safe defaults
        NAV_STATE.regime = "COMPRESSION";
        NAV_STATE.risk = "NORMAL";
        NAV_STATE.confidence = "MED";
        NAV_STATE.status = "UNKNOWN";

      } catch (err) {
        // Ultimate fail-safe: blank screen
        document.getElementById("terminal").innerHTML = "";
      }
    }

    /* ---- MAIN TICK CYCLE (Deterministic Interval) ---- */
    const TICK_INTERVAL = 3000; // 3 seconds
    let tickCount = 0;

    function tick() {
      try {
        tickCount++;

        // Update state
        updateState();

        // Render NAV
        renderNAV(NAV_STATE);

        // Render status heartbeat every 5 ticks
        if (tickCount % 5 === 0) {
          renderStatus();
        }

      } catch (err) {
        triggerFailSafe();
      }
    }

    /* ---- BOOT SEQUENCE ---- */
    (function init() {
      try {
        // Initial render
        renderNAV(NAV_STATE);
        renderStatus();

        // Start deterministic tick loop
        setInterval(tick, TICK_INTERVAL);

      } catch (err) {
        triggerFailSafe();
      }
    })();

  </script>
</body>
</html>
